---
title: 泰勒公式理解
date: 2022-12-15
categories: 
    - 数学
comments: true
draft: true
---

>微积分不能没有泰勒公式，就像西方不能失去耶路撒冷  ---沃兹基朔德
<!-- more -->

# 泰勒公式

## 引出

我们接触过很多的函数，简单函数有指数函数、三角函数、幂函数、对数函数和反三角函数。

在我们与这些函数接触的过程中，渐渐了解函数的特性，同时可以发现，有些函数很“**神秘**”。

比如三角函数 $\sin x$，中学我们就记忆过特殊角 $\cfrac{\pi}{6}$、$\cfrac{\pi}{3}$、$\cfrac{\pi}{4}$ 经 $\sin x$ 映射后的函数值是多少，根据三角函数的周期性，我们还可以把 $\sin x$ 图像在坐标系上画出来，那么你是否觉得对 $\sin x$ 已经比较了解了呢。

那我现在知道 $\sin 1$ 是多少？这下难受了吧，如果考试的时候如果算出来 $\sin 1$ 直接填上就行了，但我**现在想要的不是这个符号，而是算出来的数字是什么**。这下有没有觉得 $\sin x$ 一下又神秘了，同样的，我们可以发现很多指数函数、对数函数、幂函数都很神秘。

有神秘的函数，同样也有不神秘的函数。例如初中常见的多项式函数 $f(x) = ax^2+bx+c$

对于这个函数你发现不论给个什么数，你只要轻轻地把 $x$ 替换成输入地数，再经过简单地运算就能够得到结果，**不存在找不到映射结果对应值**的情况，可以发现对于多项式函数有上述这样一个很好的性质。而泰勒公式想做的就是用多项式函数来表示其他函数，<del>这种大一统思想早在秦朝就有所体现</del>。


## 证明

(证明过程中用到的定理：拉格朗日中值定理、柯西中值定理)

对于函数 $f(x)$，若 $f(x)$ 在 $a,b$ 为端点的区间上满足拉氏条件，则由拉格朗日中值定可得：$f(a)-f(b)=f'(\theta)(a-b),\theta\in(a,b) => f(a) = f(b) + f'(\theta)(a-b), \theta\in(a,b)$

令 $a=x,b=x_0$,若 $f(x)$ 一阶导存在,则有 $f(x)=f(x_0)+f'(\theta)(x-x_0)$ 

而若函数$f(x)$的二阶导存在，则我们猜想令$f(x)=f(x_0)+f'(x_0)(x-x_0)+K(x-x_0)^2$,

则$K=\cfrac{f(x)-[f(x_0)+f'(x_0)(x-x_0)]}{(x-x_0)^2}$（至于为什么这么猜想，Attention is all  you need ）

我们设$G(x)=f(x)-[f(x)+f'(x)(x-x_0)],H(x)=(x-x_0)^2$

又$G(x_0)=f(x_0)-[f(x_0)+f'(x_0)(x-x_0)]=0$,$H(x_0)=0$,所以$K=\cfrac{G(x)-G(x_0)}{H(x)-H(x_0)}$。

而$G'(x)=f'(x)-f'(x_0),H'(x)=2(x-x_0)$,设 $x<x_0$,由由柯西中值定理知,存在$i_1\in (x,x_0)$ 

使得 $K=\cfrac{G'(i_1)}{H'(i_1)}=\cfrac{G(x)-G(x_0)}{H(x)-H(x_0)}$。

又$G'(x_0)=H'(x_0)=0$,所以由柯西中值定理知，存在$i_2\in(i_1,x_0),K=\cfrac{G''(i_2)}{H''(i_2)}=\cfrac{f''(i_2)}{2!}$。

这下原来的式子就可以写成 $f(x)=f(x_0)+f'(x_0)(x-x_0)+\cfrac{f''(i_2)}{2!}(x-x_0)^2$,$i_2$介于$x,x_0$之间。

诶！我们发现可以一直这样“猜想”下去，假设$f(x)$ $n$ 阶可导，可以使得系数$K$的多项式的次方数越来越高，如法炮制解出系数$K$的值，可以发现，$f(x)$可以利用$n$轮柯西定理进行不断的近似,则泰勒公式就为:

$$f(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+...+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+\frac{f^{(n+1)}(x_i)}{(n+1)!}(x-x_0)^{(n+1)}，i \in (x,x_0)$$

在$x=0$处泰勒展开有一个别名——麦克劳林展开式
而麦克劳林展开式为:

$$f(x) = f(0) + f'(0)x+\frac{f''(0)}{2!}x^2+...\frac{f^{(n)}(0)}{n!}x^n+\frac{f^{(n+1)}(0)}{(n+1)!}x^{(n+1)}, i\in(x,0),(x>0)$$

## 五个函数的麦克劳林展开式

一：$e^x$:对于$e^x$来说，$f^{(n)}(0) = e^0=1$ 所以其麦克劳林展开式为:$e^x = 1+x+\cfrac{x^2}{2!}+\cfrac{x^3}{3!}+...+\cfrac{x^n}{n!}+\cfrac{e^ix^{(n+1)}}{(n+1)!}$



二：$\sin x$:$f^{(n)}(x) = \sin (x+n\frac{\pi}{2})$，分奇数和偶数讨论:

- 当$n = 2k,f^{(2k)}(0)=\sin (k\pi)=0, k = 0,1,2...$
- 当$n=2k+1,f^{(2k+1)}(0)=\sin (\frac{(2k+1)\pi}{2})=\sin (k\pi+\frac{\pi}{2})=(-1)^k,k=0,1,2...$ 

所以$\sin x$的展开式只与奇数项有关，则通项为$\cfrac{(-1)^k}{(2k+1)!}x^{2k+1}$

则可知$\sin x = x-\cfrac{1}{3!}x^3+\cfrac{1}{5!}x^5-\cfrac{1}{7!}x^7+...+\cfrac{(-1)^k}{(2k+1)!}x^{2k+1}+R_{2k+1}(x)$



三：$\cos x:f^{(n)}(x) = cos(x+n\frac{\pi}{2})$,分奇数和偶数讨论：

- 当$n = 2k,f^{(2k)}(0)=cos(k\pi)= (-1)^k,k=0,1,2...$
- 当$n=2k+1,f^{(2k+1)}(0)=cos(k\pi+\frac{\pi}{2})=0,k=0,1,2...$

所以$\cos x$的展开项只与偶数项有关，则通项为$\frac{(-1)^k}{(2k)!}x^{2k}$

则可知$\cos x=1-\frac{1}{2!}x^2+\frac{1}{4!}x^4-\frac{1}{6!}x^6+...+\frac{(-1)^k}{(2k)!}x^{2k}+R_{2k}(x)$

聪明的读者可能之前就发现了，既然$\sin x$的展开式我都已经求出来了，那我直接对其求导不就得到$\cos x$的展开式了？是的，这样求出来的答案也是正确的！



四：$\ln (1+x):$当$1+x>0,x>-1$时$f^{(n+1)}(x)$存在，$f^{(n)}(x)=(-1)^{(n-1)}(n-1)!(1+x)^{(-n)},n=1,2...,f^{(n)}(0)=(-1)^{(n-1)}(n-1)!,n=1,2,3...$

则$\ln (1+x)=x-\frac{1}{2}x^2+\frac{1}{3}x^3-\frac{1}{4}x^4+...+\frac{(-1)^{(n-1)}}{n}x^n+R_n(x)$



五：$(1+x)^a$:当$x>-1$时，$f^{(n+1)}(x)$存在，$f^{(n)}(x)=a(a-1)(a-2)...(a-n+1)(1+x)^{a-n}$

$f^{(n)}(0)=a(a-1)(a-2)...(a-n+1)$

则$(1+x)^a=1+ax+\frac{a(a-1)}{2!}x^2+\frac{a(a-1)(a-2)}{3!}x^3+...+\frac{a(a-1)(a-2)...(a-n+1)}{n!}x^n+R_n(x)$


## 常用泰勒公式
$$e ^x=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+...+\frac{x^n}{n!}+R_n(x)$$

$$\sin x=x-\frac{x^3}{3!}+\frac{x^5}{5!}-\frac{x^7}{7!}+...+\frac{x^{2k+1}}{(2k+1)!}+R_{2k+1}{x}$$

$$\cos x=1-\frac{x^2}{2!}+\frac{x^4}{4!}-\frac{x^6}{6!}+...+\frac{x^{2k}}{(2k)!}+R_{2k}{x}$$

$$\ln(1+x)=x-\frac{x^2}{2}+\frac{x^3}{3}-\frac{x^4}{4}+...+\frac{x^n}{n}+R_n{x}$$

$$(1+x)^a=1+ax+\frac{a(a-1)}{2!}x^2+\frac{a(a-1)(a-2)}{3!}x^3+...+\frac{a(a-1)...(a-n+1)}{n!}x^n+R_{n}x$$
