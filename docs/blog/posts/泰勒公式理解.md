---
title: 泰勒公式理解
date: 2022-11-15
categories: 
    - 数学
comments: true
---

>对于泰勒公式的夏季二解释
<!-- more -->

# 泰勒公式
## 常用泰勒公式
$$e ^x=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+...+\frac{x^n}{n!}+R_n(x)$$

$$\sin x=x-\frac{x^3}{3!}+\frac{x^5}{5!}-\frac{x^7}{7!}+...+\frac{x^{2k+1}}{(2k+1)!}+R_{2k+1}{x}$$

$$\cos x=1-\frac{x^2}{2!}+\frac{x^4}{4!}-\frac{x^6}{6!}+...+\frac{x^{2k}}{(2k)!}+R_{2k}{x}$$

$$\ln(1+x)=x-\frac{x^2}{2}+\frac{x^3}{3}-\frac{x^4}{4}+...+\frac{x^n}{n}+R_n{x}$$

$$(1+x)^a=1+ax+\frac{a(a-1)}{2!}x^2+\frac{a(a-1)(a-2)}{3!}x^3+...+\frac{a(a-1)...(a-n+1)}{n!}x^n+R_{n}x$$

**引出**：例：$f(x) = e^x,求f(3.15) = e^{3.15}$,即如何计算一般化的函数值

由拉格朗日中值定理，若 $f(x)$ 在 $a,b$ 为端点的区间上满足拉氏条件则，$f(a)-f(b)=f'(\theta)(a-b),\theta\in(a,b)$ ,再令 $a=x_0,b=x$ ,若 $f(x)$ 一阶导存在,则原式 $=f(x)=f(x_0)+f'(\theta)(x-x_0)$ 

而若函数$f(x)$的二阶导存在，则我们猜想令$f(x)=f(x_0)+f'(x_0)(x-x_0)+K(x-x_0)^2$,

则$K=\cfrac{f(x)-[f(x_0)+f'(x_0)(x-x_0)]}{(x-x_0)^2}$（至于为什么这么猜想，Attention is all  you need ）

我们设$G(x)=f(x)-[f(x)+f'(x)(x-x_0)],H(x)=(x-x_0)^2$

又$G(x_0)=f(x_0)-[f(x_0)+f'(x_0)(x-x_0)]=0$,$H(x_0)=0$,所以$K=\cfrac{G(x)-G(x_0)}{H(x)-H(x_0)}$,

而$G'(x)=f'(x)-f'(x_0),H'(x)=2(x-x_0)$,设 $x<x_0$,由柯西定理可得,存在$i_1\in (x,x_0)$ 使得 $K=\cfrac{G'(i)}{H'(i)}=\cfrac{G'(i_1)-G'(x_0)}{H'(i_1)-H'(x_0)}$,则存在 $i_2\in(i_1,x_0)，K=\cfrac{G''(i_2)}{H''(i_2)}=\cfrac{f''(x)}{2!}$。

诶！我们发现可以一直这样“猜想”下去，使得系数$K$的多项式的次方数越来越高，如法炮制解出系数$K$的值，则可以发现，$f(x)$可以利用$n$轮柯西定理进行不断的近似,则泰勒公式就为:

$$f(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+...+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+\frac{f^{(n+1)}(x_i)}{(n+1)!}(x-x_0)^{(n+1)}，i \in (x,x_0)$$

在$x=0$处泰勒展开有一个别名——麦克劳林展开式
而麦克劳林展开式为:

$$f(x) = f(0) + f'(0)x+\frac{f''(0)}{2!}x^2+...\frac{f^{(n)}(0)}{n!}x^n+\frac{f^{(n+1)}(0)}{(n+1)!}x^{(n+1)}, i\in(x,0),(x>0)$$

## 五个函数的麦克劳林展开式

一：$e^x$:对于$e^x$来说，$f^{(n)}(0) = e^0=1$ 所以其麦克劳林展开式为:$e^x = 1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+...+\frac{x^n}{n!}+\frac{e^ix^{(n+1)}}{(n+1)!}$



二：$\sin x$:$f^{(n)}(x) = \sin (x+n\frac{\pi}{2})$，分奇数和偶数讨论:

- 当$n = 2k,f^{(2k)}(0)=sin(k\pi)=0, k = 0,1,2...$
- 当$n=2k+1,f^{(2k+1)}(0)=sin(\frac{(2k+1)\pi}{2})=sin(k\pi+\frac{\pi}{2})=(-1)^k,k=0,1,2...$ 

所以$\sin x$的展开式只与奇数项有关，则通项为$\frac{(-1)^k}{(2k+1)!}x^{2k+1}$

则可知$\sin x = x-\frac{1}{3!}x^3+\frac{1}{5!}x^5-\frac{1}{7!}x^7+...+\frac{(-1)^k}{(2k+1)!}x^{2k+1}+R_{2k+1}(x)$



三：$\cos x:f^{(n)}(x) = cos(x+n\frac{\pi}{2})$,分奇数和偶数讨论：

- 当$n = 2k,f^{(2k)}(0)=cos(k\pi)= (-1)^k,k=0,1,2...$
- 当$n=2k+1,f^{(2k+1)}(0)=cos(k\pi+\frac{\pi}{2})=0,k=0,1,2...$

所以$\cos x$的展开项只与偶数项有关，则通项为$\frac{(-1)^k}{(2k)!}x^{2k}$

则可知$\cos x=1-\frac{1}{2!}x^2+\frac{1}{4!}x^4-\frac{1}{6!}x^6+...+\frac{(-1)^k}{(2k)!}x^{2k}+R_{2k}(x)$

聪明的读者可能之前就发现了，既然$\sin x$的展开式我都已经求出来了，那我直接对其求导不就得到$\cos x$的展开式了？是的，这样求出来的答案也是正确的！



四：$\ln (1+x):$当$1+x>0,x>-1$时$f^{(n+1)}(x)$存在，$f^{(n)}(x)=(-1)^{(n-1)}(n-1)!(1+x)^{(-n)},n=1,2...,f^{(n)}(0)=(-1)^{(n-1)}(n-1)!,n=1,2,3...$

则$\ln (1+x)=x-\frac{1}{2}x^2+\frac{1}{3}x^3-\frac{1}{4}x^4+...+\frac{(-1)^{(n-1)}}{n}x^n+R_n(x)$



五：$(1+x)^a$:当$x>-1$时，$f^{(n+1)}(x)$存在，$f^{(n)}(x)=a(a-1)(a-2)...(a-n+1)(1+x)^{a-n}$

$f^{(n)}(0)=a(a-1)(a-2)...(a-n+1)$

则$(1+x)^a=1+ax+\frac{a(a-1)}{2!}x^2+\frac{a(a-1)(a-2)}{3!}x^3+...+\frac{a(a-1)(a-2)...(a-n+1)}{n!}x^n+R_n(x)$



